---
title: "Data Exploration"
author: "Kentaro Ino"
date: "August 3, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(Quandl)
library(stringr)
library(readr)
library(stringr)
library(dplyr)
library(tidyr)
library(lubridate)
library(plyr)
library(ggplot2)
library(rvest)
library(ggmap)
library(mapdata)
library(scales)
library(shiny)
```

#Load Cleaning Data
Variables:   
bubble_data: dataframe  
map_data: dataframe
```{r}
bubble_data = read_csv("../clean_data/cleaned_bubble_data.csv")
map_data = read_csv("../clean_data/cleaned_map_data.csv")
pop_df = read_csv("../raw_data/popudata.csv") %>% 
  .[-c(1)] %>% 
  mutate(county = tolower(county)) %>%
  mutate(year = year(DATE))
gdp_df = read_csv("../raw_data/gdppcdata.csv") %>% 
  .[-c(1)] %>% 
  mutate(county = tolower(county)) %>%
  mutate(year = year(DATE))
colnames(pop_df) = c("Date","Pop","County","year")
colnames(gdp_df) = c("Date","Income","County","year")
primary = c("alameda","contra costa","san mateo","marin","napa","sacramento","santa clara","san francisco")
```


#Graphing
```{r}
states = map_data("state")
ca_df = filter(states, region == "california")
counties = map_data("county")
ca_county = filter(counties, region == "california")

ca_base = ggplot(ca_df, aes(x = long, y = lat, group = group)) + 
  coord_fixed(1.3) + 
  geom_polygon(color = "black", fill = "gray")
#Graphing the data
#Plot of  vs year
pop_plt = ggplot(pop_df,aes(x=Date,y=Pop,color=County)) +
  geom_smooth() +
  geom_line() + 
  labs(title="Population VS. Year", x = "Year(s)",y ="Population(thousand)") +
  scale_x_date(breaks = date_breaks("5 years"), date_labels = "%Y")
pop_plt

#Plot of income vs year
gdp_plt = ggplot(gdp_df,aes(x=Date,y=Income,color=County)) +
  geom_smooth() +
  geom_line() + 
  labs(title="Income VS. Year", x = "Year(s)",y ="Income per Capita (dollar)") +
  scale_x_date(breaks = date_breaks("5 years"), date_labels = "%Y")
gdp_plt

#The plots of PRR value
#Param: 
#     prr_plt: list, saving all the plots of each county
test_data = filter(bubble_data,Type == 'PRR')
Price_to_Rent_plt = list()
for(i in 1:length(primary)){
  temp = ggplot(filter(test_data,County == ignore.case(primary[i])),aes(x=Date,y=Value,color=City)) +
    geom_smooth() +
    geom_line()
  Price_to_Rent_plt[[i]] = temp
}
names(Price_to_Rent_plt) = primary

#The plots of HF value
#Param:
#     foreclosure_plt: list, saving all the plots of each county
Foreclosure_test_data=filter(bubble_data,Type=='HF')
foreclosure_plt=list()
for(i in 1:length(primary)){
  temp = ggplot(filter(Foreclosure_test_data,County == ignore.case(primary[i])),aes(x=Date,y=Value,color=City)) +
    geom_smooth() +
    geom_line()
  foreclosure_plt[[i]] = temp
}
names(foreclosure_plt)=primary

#The plots of RMP value
#Param:
#     foreclosure_plt: list, saving all the plots of each county
median_rent_data=filter(bubble_data,Type=="RMP")
median_rent_plt=list()
for(i in 1:length(primary)){
  temp = ggplot(filter(median_rent_data,County == ignore.case(primary[i])),aes(x=Date,y=Value,color=City)) +
    geom_smooth() +
    geom_line()
  median_rent_plt[[i]] = temp
}
names(median_rent_plt)=primary

#The plots of HR value
#Param:
#     foreclosure_plt: list, saving all the plots of each county
Homes_For_Rent_data=filter(bubble_data,Type=="HR")
Homes_For_Rent_plt=list()
for(i in 1:length(primary)){
  temp = ggplot(filter(Homes_For_Rent_data,County == ignore.case(primary[i])),aes(x=Date,y=Value,color=City)) +
    geom_smooth() +
    geom_line()
  Homes_For_Rent_plt[[i]] = temp
}
names(Homes_For_Rent_plt)=primary
```